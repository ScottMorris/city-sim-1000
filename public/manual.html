<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>City Sim 1000 Manual</title>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, sans-serif;
        background: #0f1629;
        color: #e8f1ff;
        line-height: 1.6;
        padding: 24px;
      }
      h1, h2 { color: #7bffb7; }
      code { background: #1c2438; padding: 2px 6px; border-radius: 4px; }
      a { color: #89c2ff; }
      ul { margin-top: 8px; }
    </style>
  </head>
  <body>
    <h1>City Sim 1000 Manual</h1>
    <p>A lightweight, offline-friendly city builder. Everything runs client side and saves to your browser.</p>

    <h2>Loading the game</h2>
    <ul>
      <li>Run <code>npm install</code> then <code>npm run dev</code> to play locally.</li>
      <li>Open the game in your browser. A service worker caches assets so it keeps working offline after the first load.</li>
      <li>Add to your home screen or app drawer using the browser install button for a standalone feel.</li>
    </ul>

    <h2>Controls</h2>
    <ul>
      <li><strong>Drag</strong> the map to pan. Use your mouse wheel or pinch to zoom.</li>
      <li><strong>Right-click</strong> to bulldoze tiles quickly — click once or hold and drag to sweep clears. Middle-click or hold <strong>Alt</strong> to pan instead. Right-click does nothing while Inspect is active.</li>
      <li>Choose a tool from the toolbar and click tiles to apply it.</li>
      <li>Hover over demand bars to view the approximate need for Residential, Commercial, and Industrial zones.</li>
      <li>Switch to the <strong>Inspect</strong> tool and click tiles to view terrain, utilities, and zone data.</li>
      <li>The tool info card beside the inspector shows cost, upkeep, and stats for the active tool; hit <em>Pin</em> to keep it always on.</li>
      <li>Use the Debug overlay button to see live stats (demand, utilities, zone counts) while tuning growth.</li>
      <li><strong>Hotkeys</strong>: Move with <code>WASD</code> or arrow keys, press <code>I</code> to enter Inspect mode, and use quick tool shortcuts: Raise (<code>E</code>), Lower (<code>Q</code>), Water paint (<code>F</code>), Trees (<code>T</code>), Road (<code>R</code>), Rail (<code>L</code>), Power Lines (<code>P</code>), Hydro Plant (<code>H</code>), Water Pump (<code>U</code>), Water Tower (<code>Y</code>), Elementary School (<code>J</code>), High School (<code>N</code>), Residential (<code>Z</code>), Commercial (<code>X</code>), Industrial (<code>C</code>), Park (<code>K</code>), Bulldoze (<code>B</code>), toggle the minimap (<code>M</code>). Set simulation speed with <code>1</code> (Slow), <code>2</code> (Fast), <code>3</code> (Ludicrous).</li>
    </ul>

    <h2>Radio</h2>
    <ul>
      <li>A compact radio widget sits on the toolbar to the left of the Budget button. Emoji buttons control playback: ⏮️ previous, ▶️/⏸️ play or pause, ⏭️ next.</li>
      <li>The current track scrolls in a short marquee with “Artist — Title”; pausing also pauses the scroll and changing tracks resets it.</li>
      <li>Hover or focus the radio to reveal a small popover above the toolbar with full track details and a larger cover preview when available. If no cover is provided, the thumbnail stays hidden.</li>
      <li>If no playlist ships with the build yet, the radio reads “Radio offline” and controls are disabled until audio is added.</li>
    </ul>

    <h2>Minimap</h2>
    <ul>
      <li>The minimap lives in the bottom-right of the HUD with a base view showing terrain, zones, roads/rail, power lines, and buildings.</li>
      <li>Click or drag on the minimap to jump or slide the main camera; the current viewport stays outlined so you always know where you are.</li>
      <li>Use the toggle button or hotkey <code>M</code> to collapse or expand the panel; size presets keep it readable without crowding the HUD.</li>
      <li>Overlay modes: <em>Base</em> (everything), <em>Power</em> (powered green, unpowered red, generation/lines teal), <em>Water</em> (water tiles, pumps, towers, pipes in blue), <em>Education</em> (schools purple, served zones green, underserved amber), and <em>Alerts</em> (abandoned/unpowered/unhappy zones glow warm). The same mode tints the main map so you can spot issues without relying on the minimap alone.</li>
    </ul>

    <h2>Tools</h2>
    <ul>
      <li><strong>Terraform</strong>: convert terrain back to land and flatten rough edges.</li>
      <li><strong>Water</strong>: flood tiles to create lakes or rivers.</li>
      <li><strong>Water Services</strong>: open the submenu for utility buildings. Place <em>Pump</em> for basic supply, <em>Water Tower</em> for extra capacity that stays on without power, and note that <em>Pipes</em> are stubbed until an underground view ships.</li>
      <li><strong>Education</strong>: open the Schools submenu and place <em>Elementary</em> or <em>High School</em>. They require power, use the road network for an 8–9 tile reach, and their coverage overlay shows which zones they serve; underserved neighbourhoods see a small demand and decay penalty.</li>
      <li><strong>Trees</strong>: add greenery for happiness and decoration.</li>
      <li><strong>Road / Rail</strong>: lay transport networks for citizens and freight.</li>
      <li><strong>Power Line</strong>: connect neighbourhoods to your hydro plants; can run over roads/rail without breaking access.</li>
      <li><strong>Hydro Plant</strong>: produces clean electricity. Place near water for flavour.</li>
      <li><strong>Residential / Commercial / Industrial</strong>: zone your city to grow population, shops, and factories. Zones cannot overwrite roads or rail—bulldoze first.</li>
      <li><strong>Bulldozer</strong>: remove buildings or networks without affecting terrain.</li>
    </ul>

    <h2>Bylaws</h2>
    <ul>
      <li>Open the <strong>Bylaws</strong> modal from the toolbar’s city admin cluster (next to Budget/Settings) to set a city-wide lighting standard.</li>
      <li><em>Mixed corridors</em> are the neutral baseline. <em>Energy-efficient</em> lighting trims civic/zone power draw and upkeep with a slight mood dip. <em>Carbon-arc lamps</em> boost ambience with higher power use and upkeep.</li>
      <li>The modal shows projected power demand and monthly upkeep deltas compared to your current policy; toggles apply immediately and save with your city.</li>
      <li>District overlays are planned; today the chosen lighting bylaw applies everywhere.</li>
    </ul>

    <h2>Economy & Utilities</h2>
    <ul>
      <li>The Budget panel shows your cash plus a monthly net projection: green for a surplus, red for a deficit, neutral when flat.</li>
      <li>Months are 30 days long; the HUD shows the current month and day so the monthly budget numbers line up with the calendar.</li>
      <li>Use the <em>Open budget</em> button in the HUD to see a quarterly breakdown (last 3 months), per-month net, and a runway estimate based on your current burn. Revenue shows the base stipend plus residents/commercial/industrial income; expenses split transport (roads/rail/lines/pipes) and buildings (power, civic, zones).</li>
      <li>Power is generated by plants; roads and rail also conduct power in addition to power lines. Water is temporarily disabled until pipes/underground view ship.</li>
      <li>Schools draw power and add upkeep; their reach rides the road network. Underserved areas see a modest drop in Residential demand and a higher chance of decay, and weak high-school coverage trims Commercial/Industrial demand.</li>
      <li>Growth needs power ≥ 0 and a road chain; zones adjacent to roads can power neighbours through the network.</li>
      <li>When power drops below zero you'll see a sticky warning toast; it clears with a follow-up notice once supply returns. Water alerts will join when pipes are live.</li>
      <li>Starter demand is seeded when the city is empty so pre-painted zones can begin to grow; normal demand formulas resume after the first builds.</li>
      <li>Unemployment and job vacancies are aggregate signals: vacancies nudge Residential demand up while unemployment nudges Commercial/Industrial up. They’re gentle modifiers, not individual citizens.</li>
      <li>Zones can abandon if demand stays very low, power is missing, or tiles are unhappy. Abandoned lots auto-clear back to zoned tiles and will regrow when demand recovers.</li>
      <li>Over-zoning is soft: pending zones gently trim demand with caps and a small floor so big paint jobs trickle-build instead of stalling. Strong demand will still punch through, but power deficits can drive it to zero.</li>
      <li>Demand bars show where citizens want you to grow next.</li>
    </ul>

    <h2>Temporary caveats</h2>
    <ul>
      <li>Water simulation is stubbed (fixed high balance); only power deficits block growth.</li>
      <li>Power lines can overlay roads/rail; future sprites will reflect crossings.</li>
      <li>Zoning over transport is blocked to prevent accidental overwrite; bulldoze transport first.</li>
    </ul>

    <h2>Saving & backups</h2>
    <ul>
      <li>Use <strong>Save to Browser</strong> to store your city in localStorage.</li>
      <li><strong>Download Save</strong> exports a JSON file so you can back it up.</li>
      <li><strong>Upload Save</strong> lets you restore any exported city.</li>
    </ul>
  </body>
</html>
